{
  "apiVersion": "argoproj.io/v1alpha1",
  "kind": "Workflow",
  "metadata": {
    "name": "k8s-jobs"
  },
  "spec": {
    "entrypoint": "rand-num",
    "templates": [
      {
        "name": "rand-num",
        "resource": {
          "action": "create",
          "successCondition": "status.succeeded > 2",
          "failureCondition": "status.failed > 1",
          "setOwnerReference": true,
          "manifest": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  generateName: rand-num-\nspec:\n  completions: 3\n  parallelism: 3\n  template:\n    metadata:\n      name: rand\n    spec:\n      containers:\n      - name: rand\n        image: python:alpine3.6\n        command: [\"python\", \"-c\", \"import random; import time; print(random.randint(1, 1000)); time.sleep(10)\"]\n      restartPolicy: Never\n"
        },
        "outputs": {
          "parameters": [
            {
              "name": "job-name",
              "valueFrom": {
                "jsonPath": "{.metadata.name}"
              }
            },
            {
              "name": "job-obj",
              "valueFrom": {
                "jqFilter": "."
              }
            }
          ]
        }
      }
    ]
  }
}